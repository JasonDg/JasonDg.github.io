<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Firefox 中 Array.sort() 能够使用 boolean 值进行判断 | JasonDG</title><meta name=keywords content="Array,sort,Firefox"><meta name=description content="前言 一次调试时，发现 Firefox 中可以通过 boolean 值来使用 Array.sort()，而在 Node.js 中仅能使用 number 类型。尽管这个问题没有造成代码错误，但还是会造成一些困"><meta name=author content><link rel=canonical href=https://jasondg.github.io/posts/firefox.sort.by.boolean/><link crossorigin=anonymous href=/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://jasondg.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jasondg.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jasondg.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jasondg.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jasondg.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://jasondg.github.io/posts/firefox.sort.by.boolean/><link rel=alternate hreflang=en href=https://jasondg.github.io/en/posts/firefox.sort.by.boolean/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Firefox 中 Array.sort() 能够使用 boolean 值进行判断"><meta property="og:description" content="前言 一次调试时，发现 Firefox 中可以通过 boolean 值来使用 Array.sort()，而在 Node.js 中仅能使用 number 类型。尽管这个问题没有造成代码错误，但还是会造成一些困"><meta property="og:type" content="article"><meta property="og:url" content="https://jasondg.github.io/posts/firefox.sort.by.boolean/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-29T21:35:39+08:00"><meta property="article:modified_time" content="2022-04-23T21:42:18+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Firefox 中 Array.sort() 能够使用 boolean 值进行判断"><meta name=twitter:description content="前言 一次调试时，发现 Firefox 中可以通过 boolean 值来使用 Array.sort()，而在 Node.js 中仅能使用 number 类型。尽管这个问题没有造成代码错误，但还是会造成一些困"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://jasondg.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Firefox 中 Array.sort() 能够使用 boolean 值进行判断","item":"https://jasondg.github.io/posts/firefox.sort.by.boolean/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Firefox 中 Array.sort() 能够使用 boolean 值进行判断","name":"Firefox 中 Array.sort() 能够使用 boolean 值进行判断","description":"前言 一次调试时，发现 Firefox 中可以通过 boolean 值来使用 Array.sort()，而在 Node.js 中仅能使用 number 类型。尽管这个问题没有造成代码错误，但还是会造成一些困","keywords":["Array","sort","Firefox"],"articleBody":"前言 一次调试时，发现 Firefox 中可以通过 boolean 值来使用 Array.sort()，而在 Node.js 中仅能使用 number 类型。尽管这个问题没有造成代码错误，但还是会造成一些困惑。\nJS 引擎间差异 简单运行下测试代码，结果如下：\n Firefox  const arr = [{num:1}, {num:3}, {num:2}] const numSorted = arr.sort((a, b) = a.num - b.num) console.log(numSorted)  Array [Object { num: 1 }, Object { num: 2 }, Object { num: 3 }] const arr = [{num:1}, {num:3}, {num:2}] const boolSorted = arr.sort((a, b) = a.num  b.num) console.log(boolSorted)  Array [Object { num: 1 }, Object { num: 2 }, Object { num: 3 }]  Node.js  const arr = [{num:1}, {num:3}, {num:2}] const sorted = arr.sort((a, b) = a.num  b.num) console.log(sorted)  [ { num: 1 }, { num: 3 }, { num: 2 } ]  Deno  const arr = [{num:1}, {num:3}, {num:2}] const sorted = arr.sort((a, b) = a.num  b.num) console.log(sorted)  [ { num: 1 }, { num: 3 }, { num: 2 } ] 可以发现，Node 与 Deno 同样使用 V8 引擎，仅能在 Array.sort()中使用 number 类型作为判断，而 Firefox 中能够使用 number 或 boolean 值作为判断。\nTypeScript 中 Array.sort()的类型 在 TypeScript 中 Array.sort()的类型为\n(method) Array.sort(compareFn?: ((a: T, b: T) = number) | undefined): T[] 尝试使用 boolean 类型的 sort(),但 TS 报出类型错误:\nArgument of type '(a: { num: number; }, b: { num: number; }) = boolean' is not assignable to parameter of type '(a: { num: number; }, b: { num: number; }) = number'. Type 'boolean' is not assignable to type 'number'.ts(2345) MDN 文档与 ECMA 标准 查阅 MDN 文档1，\n So, the compare function has the following form:\nfunction compare(a, b) { if (a is less than b by some ordering criterion) { return -1; } if (a is greater than b by the ordering criterion) { return 1; } // a must be equal to b return 0; }  说明中并未标明可以使用 boolean 值，继续查阅 ECMA 文档2,\n  If x and y are both undefined, return +0𝔽. If x is undefined, return 1𝔽. If y is undefined, return -1𝔽. If comparefn is not undefined, then  Let v be ? ToNumber(? Call(comparefn, undefined, « x, y »)). If v is NaN, return +0𝔽. Return v.   Let xString be ? ToString(x). Let yString be ? ToString(y). Let xSmaller be ! IsLessThan(xString, yString, true). If xSmaller is true, return -1𝔽. Let ySmaller be ! IsLessThan(yString, xString, true). If ySmaller is true, return 1𝔽. Return +0𝔽.   标准中同样也未指出可以使用 boolean 值进行判断。\n总结 Firefox 中能够使用 boolean 值进行判断，可能是 Firefox 的实现问题，在相关文档与标准中并没有相关说明。实际写代码时，在 lint 工具等约束后应该并不会产生异常问题，仅是出于好奇进行了一些检索，简单记录一下。\n  https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort ↩︎\n https://tc39.es/ecma262/multipage/indexed-collections.html#sec-array.prototype.sort ↩︎\n   ","wordCount":"703","inLanguage":"zh","datePublished":"2022-03-29T21:35:39+08:00","dateModified":"2022-04-23T21:42:18+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jasondg.github.io/posts/firefox.sort.by.boolean/"},"publisher":{"@type":"Organization","name":"JasonDG","logo":{"@type":"ImageObject","url":"https://jasondg.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jasondg.github.io/ accesskey=h title="JasonDG (Alt + H)">JasonDG</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://jasondg.github.io/en/ title=English aria-label=English>English</a></li></ul></span></div><ul id=menu><li><a href=https://jasondg.github.io/archives/ title=文章><span>文章</span></a></li><li><a href=https://jasondg.github.io/categories/ title=分类><span>分类</span></a></li><li><a href=https://jasondg.github.io/tags/ title=标签><span>标签</span></a></li><li><a href=https://jasondg.github.io/search/ title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Firefox 中 Array.sort() 能够使用 boolean 值进行判断</h1><div class=post-meta><span title="2022-03-29 21:35:39 +0800 +0800">三月 29, 2022</span>&nbsp;·&nbsp;2 分钟&nbsp;|&nbsp;<ul class=i18n_list>语言:<li><a href=https://jasondg.github.io/en/posts/firefox.sort.by.boolean/>English</a></li></ul></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e5%89%8d%e8%a8%80 aria-label=前言>前言</a></li><li><a href=#js-%e5%bc%95%e6%93%8e%e9%97%b4%e5%b7%ae%e5%bc%82 aria-label="JS 引擎间差异">JS 引擎间差异</a></li><li><a href=#typescript-%e4%b8%ad-arraysort%e7%9a%84%e7%b1%bb%e5%9e%8b aria-label="TypeScript 中 Array.sort()的类型">TypeScript 中 Array.sort()的类型</a></li><li><a href=#mdn-%e6%96%87%e6%a1%a3%e4%b8%8e-ecma-%e6%a0%87%e5%87%86 aria-label="MDN 文档与 ECMA 标准">MDN 文档与 ECMA 标准</a></li><li><a href=#%e6%80%bb%e7%bb%93 aria-label=总结>总结</a></li></ul></div></details></div><div class=post-content><h1 id=前言>前言<a hidden class=anchor aria-hidden=true href=#前言>#</a></h1><p>一次调试时，发现 Firefox 中可以通过 boolean 值来使用 Array.sort()，而在 Node.js 中仅能使用 number 类型。尽管这个问题没有造成代码错误，但还是会造成一些困惑。</p><h1 id=js-引擎间差异>JS 引擎间差异<a hidden class=anchor aria-hidden=true href=#js-引擎间差异>#</a></h1><p>简单运行下测试代码，结果如下：</p><ul><li>Firefox</li></ul><pre tabindex=0><code>const arr = [{num:1}, {num:3}, {num:2}]
const numSorted = arr.sort((a, b) =&gt; a.num - b.num)
console.log(numSorted)

&gt; Array [Object { num: 1 }, Object { num: 2 }, Object { num: 3 }]
</code></pre><pre tabindex=0><code>const arr = [{num:1}, {num:3}, {num:2}]
const boolSorted = arr.sort((a, b) =&gt; a.num &gt; b.num)
console.log(boolSorted)

&gt; Array [Object { num: 1 }, Object { num: 2 }, Object { num: 3 }]
</code></pre><ul><li>Node.js</li></ul><pre tabindex=0><code>const arr = [{num:1}, {num:3}, {num:2}]
const sorted = arr.sort((a, b) =&gt; a.num &gt; b.num)
console.log(sorted)

&gt; [ { num: 1 }, { num: 3 }, { num: 2 } ]
</code></pre><ul><li>Deno</li></ul><pre tabindex=0><code>const arr = [{num:1}, {num:3}, {num:2}]
const sorted = arr.sort((a, b) =&gt; a.num &gt; b.num)
console.log(sorted)

&gt; [ { num: 1 }, { num: 3 }, { num: 2 } ]
</code></pre><p>可以发现，Node 与 Deno 同样使用 V8 引擎，仅能在 Array.sort()中使用 number 类型作为判断，而 Firefox 中能够使用 number 或 boolean 值作为判断。</p><h1 id=typescript-中-arraysort的类型>TypeScript 中 Array.sort()的类型<a hidden class=anchor aria-hidden=true href=#typescript-中-arraysort的类型>#</a></h1><p>在 TypeScript 中 Array.sort()的类型为</p><pre tabindex=0><code>(method) Array&lt;T&gt;.sort(compareFn?: ((a: T, b: T) =&gt; number) | undefined): T[]
</code></pre><p>尝试使用 boolean 类型的 sort(),但 TS 报出类型错误:</p><pre tabindex=0><code>Argument of type &#39;(a: { num: number; }, b: { num: number; }) =&gt; boolean&#39; is not assignable to parameter of type &#39;(a: { num: number; }, b: { num: number; }) =&gt; number&#39;.
  Type &#39;boolean&#39; is not assignable to type &#39;number&#39;.ts(2345)
</code></pre><h1 id=mdn-文档与-ecma-标准>MDN 文档与 ECMA 标准<a hidden class=anchor aria-hidden=true href=#mdn-文档与-ecma-标准>#</a></h1><p>查阅 MDN 文档<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>，</p><blockquote><p>So, the compare function has the following form:</p><pre tabindex=0><code>function compare(a, b) {
 if (a is less than b by some ordering criterion) {
   return -1;
 }
 if (a is greater than b by the ordering criterion) {
   return 1;
 }
 // a must be equal to b
 return 0;
}
</code></pre></blockquote><p><a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#description>说明</a>中并未标明可以使用 boolean 值，继续查阅 ECMA 文档<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>,</p><blockquote><ol><li>If x and y are both undefined, return +0𝔽.</li><li>If x is undefined, return 1𝔽.</li><li>If y is undefined, return -1𝔽.</li><li>If comparefn is not undefined, then<ul><li>Let v be ? ToNumber(? Call(comparefn, undefined, « x, y »)).</li><li>If v is NaN, return +0𝔽.</li><li>Return v.</li></ul></li><li>Let xString be ? ToString(x).</li><li>Let yString be ? ToString(y).</li><li>Let xSmaller be ! IsLessThan(xString, yString, true).</li><li>If xSmaller is true, return -1𝔽.</li><li>Let ySmaller be ! IsLessThan(yString, xString, true).</li><li>If ySmaller is true, return 1𝔽.</li><li>Return +0𝔽.</li></ol></blockquote><p><a href=https://tc39.es/ecma262/multipage/indexed-collections.html#sec-array.prototype.sort>标准</a>中同样也未指出可以使用 boolean 值进行判断。</p><h1 id=总结>总结<a hidden class=anchor aria-hidden=true href=#总结>#</a></h1><p>Firefox 中能够使用 boolean 值进行判断，可能是 Firefox 的实现问题，在相关文档与标准中并没有相关说明。实际写代码时，在 lint 工具等约束后应该并不会产生异常问题，仅是出于好奇进行了一些检索，简单记录一下。</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort>https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://tc39.es/ecma262/multipage/indexed-collections.html#sec-array.prototype.sort>https://tc39.es/ecma262/multipage/indexed-collections.html#sec-array.prototype.sort</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://jasondg.github.io/tags/array/>Array</a></li><li><a href=https://jasondg.github.io/tags/sort/>sort</a></li><li><a href=https://jasondg.github.io/tags/firefox/>Firefox</a></li></ul><nav class=paginav><a class=prev href=https://jasondg.github.io/posts/container.websocket.502/><span class=title>« 上一页</span><br><span>端口映射后容器内 WebSocket 产生 502 Bad Gateway 错误</span></a>
<a class=next href=https://jasondg.github.io/posts/0/><span class=title>下一页 »</span><br><span>0</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://jasondg.github.io/>JasonDG</a></span>
&bull;
<span>使用 <a href=http://creativecommons.org/licenses/by-sa/4.0 target=_blank>CC BY-SA 4.0</a> 许可</span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="复制";function s(){e.innerText="已复制！",setTimeout(()=>{e.innerText="复制"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>